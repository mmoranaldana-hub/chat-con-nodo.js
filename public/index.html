<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ChatNodo â€” Corregido</title>
  <style>
    :root{ --bg:#e9edef; --panel:#fff; --accent:#25D366; --muted:#8a9398; --me:#DCF8C6; --them:#ffffff; --header:#075E54; --text:#111827; --dark-bg:#0f1720; --dark-panel:#111827; --dark-text:#e6eef3; }
    *{box-sizing:border-box;margin:0;padding:0;font-family:Inter,Segoe UI,Arial,Helvetica,sans-serif}
    html,body,#root{height:100%}
    body{height:100vh;background:var(--bg);color:var(--text)}
    .app{height:100vh;display:flex;gap:18px;padding:18px}
    .sidebar{width:320px;background:var(--panel);border-radius:12px;display:flex;flex-direction:column;overflow:hidden;box-shadow:0 6px 18px rgba(0,0,0,0.07)}
    .top{display:flex;align-items:center;justify-content:space-between;padding:12px;border-bottom:1px solid #eee}
    .brand{display:flex;align-items:center;gap:10px}
    .logo{width:44px;height:44;border-radius:50%;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#cfe9d6,#8fd6a0);color:#fff;font-weight:700}
    .search{padding:10px;border-bottom:1px solid #eee}
    .search input{width:100%;padding:8px;border-radius:20px;border:1px solid #e6e6e6}
    .profile{display:flex;align-items:center;gap:12px;padding:12px;border-bottom:1px solid #eee}
    .me-avatar{width:56px;height:56;border-radius:50%;background:#ddd;display:flex;align-items:center;justify-content:center;font-weight:700;overflow:hidden}
    .me-avatar img{width:100%;height:100%;object-fit:cover}
    .me-info .name{font-weight:700}
    .small{font-size:12px;color:var(--muted)}
    .tools{display:flex;gap:8px;padding:10px;border-bottom:1px solid #f0f0f0}
    .list{overflow:auto;padding:8px;flex:1;min-height:0}
    .item{display:flex;gap:10px;align-items:center;padding:8px;border-radius:8px;cursor:pointer}
    .item:hover{background:#f4f7f6}
    .msg{max-width:72%;padding:10px 12px;border-radius:8px;margin-bottom:8px;box-shadow:0 1px 0 rgba(0,0,0,0.03);word-break:break-word}
    .composer{display:flex;gap:10px;padding:12px;border-top:1px solid #f0f0f0;align-items:center}
    .composer input{flex:1;padding:10px;border-radius:20px;border:1px solid #e6e6e6}
    .btn{background:var(--header);color:#fff;border:none;padding:9px 14px;border-radius:8px;cursor:pointer}
  </style>
</head>
<body>
  <div id="root">
    <div id="auth" style="display:none;max-width:480px;margin:30px auto;padding:18px;background:#fff;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,0.06)">
      <h2 id="auth-title">Inicia sesiÃ³n</h2>
      <div id="login-form">
        <input id="login-username" placeholder="Usuario" style="width:100%;padding:10px;margin-bottom:8px;border-radius:8px;border:1px solid #ddd" />
        <input id="login-password" type="password" placeholder="ContraseÃ±a" style="width:100%;padding:10px;margin-bottom:8px;border-radius:8px;border:1px solid #ddd" />
        <div style="display:flex;gap:8px"><button class="btn" id="login-btn">Entrar</button><button id="show-register" style="padding:9px 14px">RegÃ­strate</button></div>
      </div>
      <div id="register-form" style="display:none;margin-top:10px">
        <input id="reg-username" placeholder="Usuario" style="width:100%;padding:10px;margin-bottom:8px;border-radius:8px;border:1px solid #ddd" />
        <input id="reg-password" type="password" placeholder="ContraseÃ±a" style="width:100%;padding:10px;margin-bottom:8px;border-radius:8px;border:1px solid #ddd" />
        <div style="display:flex;gap:8px"><button class="btn" id="reg-btn">Crear cuenta</button><button id="show-login" style="padding:9px 14px">Iniciar sesiÃ³n</button></div>
      </div>
      <div id="auth-msg" style="color:#b00;margin-top:8px"></div>
    </div>

    <div class="app" id="app" style="display:none;min-height:0">
      <aside class="sidebar panel">
        <div class="top">
          <div class="brand"><div class="logo">CN</div><div><strong>ChatNodo</strong><div class="small">Node + Socket.io</div></div></div>
          <div style="display:flex;gap:8px">
            <button id="toggle-dark" title="Modo oscuro" style="padding:8px;border-radius:8px">ðŸŒ“</button>
          </div>
        </div>

        <div class="search"><input id="search" placeholder="Buscar contactos o grupos..." /></div>

        <div class="profile">
          <label class="me-avatar" id="me-avatar" title="tu foto de perfil">
            <img id="me-avatar-img" src="" alt="" style="display:none" />
            <div id="me-avatar-initial">ME</div>
          </label>
          <div style="flex:1">
            <div class="me-info"><div id="me-name">Invitado</div><div class="small" id="me-presence">Desconectado</div></div>
            <div style="margin-top:6px;display:flex;gap:6px;align-items:center">
              <input id="avatar-file" type="file" accept="image/*" style="display:none" />
              <button id="change-avatar" class="btn" style="padding:6px 10px">Cambiar foto</button>
              <button id="edit-desc" style="padding:6px 10px">Editar descripciÃ³n</button>
            </div>
            <div id="me-desc" class="small" style="margin-top:6px;max-width:220px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap"></div>
          </div>
        </div>

        <div class="tools">
          <input id="add-contact-name" placeholder="Agregar contacto" style="flex:1;padding:8px;border-radius:8px;border:1px solid #ddd" />
          <button id="add-contact-btn" class="btn">AÃ±adir</button>
        </div>

        <div style="padding:10px;border-bottom:1px solid #f0f0f0;display:flex;gap:8px">
          <input id="new-group-name" placeholder="Crear grupo (nombre)" style="flex:1;padding:8px;border-radius:8px;border:1px solid #ddd" />
          <button id="create-group-btn" class="btn">Crear</button>
        </div>

        <div class="list" id="contacts-list"></div>
      </aside>

      <main class="chat panel">
        <div class="head">
          <div style="display:flex;align-items:center;gap:12px">
            <div class="me-avatar" id="chat-avatar">G</div>
            <div><div id="chat-name" style="font-weight:700">Global</div><div class="small" id="chat-sub">Chat pÃºblico</div></div>
          </div>
          <div style="margin-left:auto;display:flex;align-items:center;gap:8px">
            <div id="user-count" class="small">0 online</div>
            <button id="logout-btn" class="btn" style="background:rgba(255,255,255,0.12);border:0">Salir</button>
          </div>
        </div>

        <div class="messages" id="messages"></div>

        <div class="composer">
          <button id="emoji-btn" class="btn">ðŸ˜€</button>
          <input id="message-input" placeholder="Escribe un mensaje..." />
          <button id="send-btn" class="btn">Enviar</button>
        </div>
      </main>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/js/main.js"></script>
</body>
</html>